
{%load static%}
<!DOCTYPE html>
	<html lang="en">
		<head>
			<meta charset="UTF-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1.0" />
			<title>ECO Problem Details</title>
			<!-- <link rel="stylesheet" href="css/version2/pro-page.css" /> -->
			<link rel="stylesheet" href="{%static 'css/version2/projects-page.css'%}" />
			<link rel="stylesheet" href="{%static 'css/version2/problems.css'%}" />
			<link rel="stylesheet" href="{%static 'css/version2/problem-details.css'%}" />
			<link rel="stylesheet" href="{%static 'components/fullscreen-img/full-screen.css'%}" />
			<script src="{%static 'components/navbar/navbar.js'%}" async></script>
		</head>
		<body>
			<nav>
				<nav-bar></nav-bar>
			</nav>
			{% include "components/alert.html" %}
			<section class="container">
				<nav class="tab">
					<a href="{%url 'projects'%}" role="heading" class="tab__item">projects</a>
					<a href="{%url 'problems'%}" role="heading" class="tab__item active"
						>problems</a
					>
				</nav>

				<main class="main">
					<section class="problems__wrapper">
						<aside class="top-bar">
							<form class="form">
								<img
									src="assets/icons/search.png"
									alt="search projects"
									class="form__search toggle-form"
									title="Search projects"
								/>
								<label class="form__label hidden">
									<span class="form__close" title="hide form">x</span>
									<input
										type="search"
										placeholder="search..."
										name="search"
										class="form__input"
									/>
								</label>
							</form>
							<button type="button" role="link" class="toggle-sidebar">
								top projects
							</button>
						</aside>

						<!-- problem card -->
						<article class="card problem-card">
							<div class="card-header">
								<!-- user -->
								<p class="card-header__item card-user">
									<img
										src="{{problem.user.user_profile.profile_image.url}}"
										alt="user avatar"
										class="icon avatar"
									/><span class="username">{{problem.user.user_profile.full_name}}</span>
								</p>
								<!-- location -->
								<p class="card-header__item">
									<img
										src="assets/icons/material-symbols_location-on.png"
										alt=""
										aria-hidden="true"
										class="icon location-icon"
									/>
									{{problem.location}}
								</p>
								<!-- ECO Category -->
								<p class="card-header__item">
									Eco Category: <span class="eco-category">{{problem.category.name}}</span>
								</p>
							</div>
							<!-- card text -->
							<p class="card--txt">
								{{problem.description}}
							</p>
							<!-- problem images -->
							<section class="card__img-container">
								<img
									src="{{problem.img_one.url}}"
									alt="problem description image"
									class="card__img fullscreen-img"
								/>
								<img
									src="{{problem.img_two.url}}"
									alt="problem description image"
									class="card__img fullscreen-img"
								/>
								<img
									src="{{problem.img_three.url}}"
									alt="problem description image"
									class="card__img fullscreen-img"
								/>
							</section>
							<div class="card__footer">
								<p class="goal goal-tag">
									UNSdg Gaol: {{problem.goal.goal_no}}: {{problem.goal.name}}
								</p>
								<p class="posted-at">
									Posted: <span class="date">{{problem.created_at}}</span>
								</p>
							</div>
							<section class="card-action-group add-problem-group" role="group">
								{% csrf_token %}
								<!-- upvote -->
								<div class="card__action--item">
									<button class="like-btn" data-problem_id="{{ problem.id }}" data-action="like" style="border: none; background: none;">
										<img src="{% static 'assets/icons/upvote.png' %}" alt="upvote" class="icon upvote" />
									</button>
									<span class="upvote__count" data-problem_id="{{ problem.id }}">
										{{ problem.liked_by.count }}
									</span>
								</div>
								
								<!-- downvote -->
								<div class="card__action--item">
									<button class="dislike-btn" data-problem_id="{{ problem.id }}" data-action="dislike" style="border: none; background: none;">
										<img src="{% static 'assets/icons/downvote.png' %}" alt="downvote" class="icon downvote" />
									</button>
									<span class="downvote__count" data-problem_id="{{ problem.id }}">
										{{ problem.disliked_by.count }}
									</span>
								</div>
								

															

								<!-- ideas -->
								<div class="card__action--item">
									<img
										src="{%static 'assets/icons/ideas.png'%}"
										alt="ideas"
										class="icon idea"
									/>
									<span class="idea__count">{{comments | length}}</span>
								</div>
								<!-- share -->
								<div class="card__action--item share">
									<img
										src="{%static 'assets/icons/share.svg'%}"
										alt="share"
										class="icon share-icon"
									/>
								</div>
							</section>
						</article>
						<!-- add idea input -->
						<form class="add-idea" method='post' action=''>
						{% csrf_token %}
							<textarea
								name="idea"
								id="add-idea-input"
								required
								placeholder="Share an idea on this problem"
								class="add-idea__input"
							></textarea>
							<button type="submit" class="submit-idea">
								<img
									src="{%static 'assets/icons/send-2.png'%}"
									alt=""
									aria-hidden="true"
									class="icon"
								/>
								<span>post</span>
							</button>
						</form>
					{% comment %} comments for problem {% endcomment %}

					{% for comment in comments %}

										<!-- comment card -->
						<article class="card idea-card">
							<div class="card-header">
								<!-- user -->
								<p class="card-header__item card-user">
									<img
										src="{{comment.user.user_profile.profile_image.url}}"
										alt="user avatar"
										class="icon avatar"
									/><span class="username">{{comment.user.user_profile.full_name}}</span>
								</p>
								<p class="posted-at">
									Posted: <span class="date">{{comment.created_at}}</span>
								</p>
							</div>
							<!-- card text -->
							<p class="card--txt">
							{{comment.text}}
							</p>
							<section class="card-action-group add-problem-group" role="group">
								<!-- reply -->
								<!-- <div class="card__action--item" title="Reply">
									<img
										src="assets/icons/undo.png"
										alt="reply"
										class="icon reply"
									/>
									<span class="">Reply</span>
								</div> -->
								<!-- upvote -->
								<div class="card__action--item" title="Upvote">
									<img
										src="{% static 'assets/icons/upvote.png'%}"
										alt="upvote"
										class="icon upvote"
									/>
									<span class="upvote__count">{{comment.likes}}</span>
								</div>
								<!-- downvote -->
								<div class="card__action--item" title="Downvote">
									<img
										src="{%static 'assets/icons/downvote.png'%}"
										alt="downvote"
										class="icon downvote"
									/>
									<span class="downvote__count">{{comment.dislikes}}</span>
								</div>
								<!-- ideas -->
								<div class="card__action--item idea-wrapper" title="Idea">
									<img
										src="{%static 'assets/icons/ideas.png'%}"
										alt="ideas"
										class="icon idea"
									/>
									<span class="idea__count">0</span>
								</div>
							</section>
						</article>
						<!-- comment card -->

					{% endfor %}
					</section>
					<aside class="sidebar">
						<form class="search-form" role="search">
							<img
								src="{%static 'assets/icons/search.png'%}"
								alt="search projects"
								class="search-icon"
								title="Search projects"
							/>
							<label class="search-form__label">
								<input
									type="search"
									placeholder="Search the Eco"
									name="search"
									class="search-form__input"
								/>
							</label>
						</form>
						<h4 class="sidebar__heading">top projects</h4>
						<section class="sidebar__cards--wrapper">
							<img
								src="{%static 'assets/icons/x-lg.svg'%}"
								alt="close"
								role="button"
								class="icon hide-sidebar"
							/>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
							<!-- CARD -->
							<div class="sidebar__card">
								<p class="paragraph">
									Promoting sustainable practices in the fashion and textile
									industry.
								</p>
								<p class="sidebar__card--info">
									Posted by: <span class="card-poster">The Poster</span>
								</p>
							</div>
						</section>
					</aside>
				</main>
			</section>
			<footer class="footer">
				<p class="copyright">&copy; 2023 Eco Africa. All rights reserved</p>
			</footer>
			<!-- template for displaying image fullscreen -->
			<!-- [add 'fullscreen-img' to the class of all images to display fullscreen] -->
			<template class="featured__item--template">
				<div class="featured__item">
					<img src="" alt="" class="featured-img" />
				</div>
			</template>

			<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

			<script type="module" src="{%static 'js/app.js'%}"></script>
			<script src="{%static 'js/problems.js'%}" type="module"></script>
			<script src="{% static 'js/likedetailpage.js' %}"></script>
			<script src="{%static 'js/projects-page.js'%}"></script>
			<script src="{%static 'components/fullscreen-img/fullscreen-img.js'%}"></script>
		</body>
	</html>
